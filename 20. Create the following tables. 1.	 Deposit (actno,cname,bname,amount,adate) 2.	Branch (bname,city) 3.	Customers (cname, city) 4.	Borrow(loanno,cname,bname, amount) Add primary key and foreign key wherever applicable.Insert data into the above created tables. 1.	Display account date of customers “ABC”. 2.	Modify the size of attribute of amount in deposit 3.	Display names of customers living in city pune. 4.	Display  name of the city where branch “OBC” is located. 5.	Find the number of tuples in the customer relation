-- Create database and use it
CREATE DATABASE IF NOT EXISTS bankDB3;
USE bankDB3;

-- Drop tables if exist to avoid conflicts
DROP TABLE IF EXISTS Borrow;
DROP TABLE IF EXISTS Deposit;
DROP TABLE IF EXISTS Customers;
DROP TABLE IF EXISTS Branch;

-- Create Branch table
CREATE TABLE Branch (
    bname VARCHAR(50) PRIMARY KEY,
    city VARCHAR(50) NOT NULL
);

-- Create Customers table
CREATE TABLE Customers (
    cname VARCHAR(100) PRIMARY KEY,
    city VARCHAR(50) NOT NULL
);

-- Create Deposit table
CREATE TABLE Deposit (
    actno INT PRIMARY KEY,
    cname VARCHAR(100),
    bname VARCHAR(50),
    amount DECIMAL(12,2) NOT NULL CHECK (amount >= 0),
    adate DATE NOT NULL,
    FOREIGN KEY (cname) REFERENCES Customers(cname),
    FOREIGN KEY (bname) REFERENCES Branch(bname)
);

-- Create Borrow table
CREATE TABLE Borrow (
    loanno INT PRIMARY KEY,
    cname VARCHAR(100),
    bname VARCHAR(50),
    amount DECIMAL(12,2) NOT NULL CHECK (amount >= 0),
    FOREIGN KEY (cname) REFERENCES Customers(cname),
    FOREIGN KEY (bname) REFERENCES Branch(bname)
);

-- Insert sample data into Branch
INSERT INTO Branch VALUES
('OBC', 'Pune'),
('SBI', 'Mumbai'),
('HDFC', 'Pune');

-- Insert sample data into Customers
INSERT INTO Customers VALUES
('ABC', 'Pune'),
('DEF', 'Mumbai'),
('GHI', 'Pune'),
('JKL', 'Delhi');

-- Insert sample data into Deposit
INSERT INTO Deposit VALUES
(1001, 'ABC', 'OBC', 5000, '2024-05-01'),
(1002, 'DEF', 'SBI', 7000, '2024-05-03'),
(1003, 'GHI', 'OBC', 6500, '2024-05-04'),
(1004, 'JKL', 'HDFC', 8000, '2024-05-05');

-- Insert sample data into Borrow
INSERT INTO Borrow VALUES
(2001, 'ABC', 'OBC', 20000),
(2002, 'DEF', 'SBI', 15000);

-- 1. Display account date (adate) of customer "ABC"
SELECT actno, adate FROM Deposit WHERE cname = 'ABC';

-- 2. Modify the size of attribute 'amount' in Deposit table
-- Since amount is DECIMAL(12,2), letâ€™s increase it to DECIMAL(15,2)
ALTER TABLE Deposit MODIFY amount DECIMAL(15,2) NOT NULL;

-- To verify the change, describe the Deposit table:
DESCRIBE Deposit;

-- 3. Display names of customers living in city Pune
SELECT cname FROM Customers WHERE city = 'Pune';

-- 4. Display name of the city where branch "OBC" is located
SELECT city FROM Branch WHERE bname = 'OBC';

-- 5. Find the number of tuples in the customer relation
SELECT COUNT(*) AS Number_of_Customers FROM Customers;
